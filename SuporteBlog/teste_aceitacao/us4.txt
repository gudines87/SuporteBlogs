####################################################################################################
#User Story-- Criar Blogs
#
#Cadastra um Blog, associando-o a um usuрrio. No ato da criaусo deve-se fornecer as seguintes informaушes:
#* Titulo do blog
#* Descriусo do Bloco
#* Nome da imagem de background
#* autorizacao para comentarios
#* autorizacao para comentarios anonimos
#Restriушes
#    -O usuрrio deve estar logado no sistema (Fornecimento de um id de sessсo vрlido)
#   
#    -Campos obrigatзrios:
#        * Titulo do blog;
#	 * nome da imagem de fundo
#
#    -Uma conta poderр possuir no mрximo 3 blogs
#
#    -Para que se autorize o comentрrio de usuрrios anonimos, obrigatoriamente deve-se autorizar a realizaусo de comentрrios
# O blog, diferentemente de um usuрrio, terр o conceito de id's. 
#Isto ж necessрrio porque em um blog nсo existe nenhuma informaусo Щnica (Como o login em usuрrios).
#Podem existir blogs com mesmo nome e descriусo
#
######################################################################################################

#Limpa quaisquer dados pre-existentes
resetDatabase

createProfile login=mariasilva senha=qwe2axdcq2 nome_exibicao="Maria Silva" email=maria@gmail.com sexo=Feminino data_nasc=01/01/1980 endereco="Rua das cocadas" interesses="ping pong" quem_sou_eu="E... boa pergunta!" filmes="e o vento levou" musicas=MPB livros="poeira em alto mar"


#Efetua login do usuрrio
sessionId1=doLogin login=mariasilva senha=qwe2axdcq2

#Validaусo: Id de sessсo invрlido
expectError "Sessсo invрlida" createBlog sessionId=XXX titulo="myblog" descricao="Quidquid latine dictum sit, altum viditur" background="imagem.png" autz_comment=false autz_comment_annon=false

#Validaусo: Tьtulo do blog obrigatзrio
expectError "Campo invрlido: tьtulo" createBlog sessionId=${sessionId1} titulo= descricao="Quidquid latine dictum sit, altum viditur" background="imagem.png" autz_comment=false autz_comment_annon=false
expectError "Campo invрlido: tьtulo" createBlog sessionId=${sessionId1} titulo="" descricao="Quidquid latine dictum sit, altum viditur" background="imagem.png" autz_comment=false autz_comment_annon=false

#Validaусo: imagem de background obrigatoria
expectError "Campo invрlido: background" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background= autz_comment=false autz_comment_annon=false
expectError "Campo invрlido: background" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="" autz_comment=false autz_comment_annon=false

expectError "Campo invрlido: autorizaусo de comentрrios" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment= autz_comment_annon=false
expectError "Campo invрlido: autorizaусo de comentрrios" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment="" autz_comment_annon=false
expectError "Campo invрlido: autorizaусo de comentрrios" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment=ssdf autz_comment_annon=false

expectError "Campo invрlido: autorizaусo de comentрrios anЗnimos" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment=true autz_comment_annon=
expectError "Campo invрlido: autorizaусo de comentрrios anЗnimos" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment=true autz_comment_annon=""
expectError "Campo invрlido: autorizaусo de comentрrios anЗnimos" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="image.png" autz_comment=true autz_comment_annon=sfas


expectError "Campo invрlido: comentрrios devem ser habilitados" createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="imagem.png" autz_comment=false autz_comment_annon=true

#Cria um blog
blogId=createBlog sessionId=${sessionId1} titulo="Meu primeiro blog" descricao="Quidquid latine dictum sit, altum viditur" background="imagem.png" autz_comment=true autz_comment_annon=true
blogId2=createBlog sessionId=${sessionId1} titulo="Meu segundo blog" descricao="Whatever is said in Latin sounds profound" background="imagem2.png" autz_comment=true autz_comment_annon=true
blogId3=createBlog sessionId=${sessionId1} titulo="Meu terceiro blog" descricao="Whatever is said in Latin sounds profound" background="imagem3.png" autz_comment=true autz_comment_annon=true
expectError "NЩmero mрximo de blogs por usuрrio excedido" createBlog sessionId=${sessionId1} titulo="Meu quarto blog" descricao="Quidquid latine dictum sit, altum viditur" background="" autz_comment=true autz_comment_annon=true

expectDifferent ${blogId} echo ${blogId2}

#Retorna informaушes do blog a partir do id do blog
expect "Meu primeiro blog" getBlogInformation id=${blogId} atributo=titulo
expect "Quidquid latine dictum sit, altum viditur" getBlogInformation id=${blogId} atributo=descricao
expect "imagem.png" getBlogInformation id=${blogId} atributo=background
expect true getBlogInformation id=${blogId} atributo=autz_comment
expect true getBlogInformation id=${blogId} atributo=autz_comment_annon

expect "Meu segundo blog" getBlogInformation id=${blogId2} atributo=titulo
expect "Whatever is said in Latin sounds profound" getBlogInformation id=${blogId2} atributo=descricao
expect "imagem2.png" getBlogInformation id=${blogId2} atributo=background

#Deve ser possivel recuperar o proprietario do blog
expect mariasilva getBlogInformation id=${blogId} atributo=dono
expect mariasilva getBlogInformation id=${blogId2} atributo=dono


expectError "Atributo invрlido" getBlogInformation id=${blogId2} atributo=XXX
expectError "Atributo invрlido" getBlogInformation id=${blogId2} atributo=""
expectError "Atributo invрlido" getBlogInformation id=${blogId2} atributo= 


#Desloga usuрrio
logoff sessionId=${sessionId1}